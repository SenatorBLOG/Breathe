
//Delete database
# clear_sessions.ps1
try {
    $url = "http://localhost:5000/api/sessions"
    Write-Host "Deleting all session data..."
    Invoke-RestMethod -Uri $url -Method DELETE -ErrorAction Stop
    Write-Host "✅ All session data deleted successfully!"
}
catch {
    Write-Host "❌ Error deleting sessions: $_"
}


//Create 120 random session
# Количество записей
$entriesCount = 10

$startDate = (Get-Date).AddYears(-1)
$endDate = Get-Date


$timeOfDayOptions = @("Morning", "Afternoon", "Evening", "Night")
$moods = @("Happy", "Sad", "Calm", "Excited", "Tired", "Stressed", "Relaxed", "Anxious", "Neutral", "Joyful")

1..$entriesCount | ForEach-Object {
    try {

        $randomDate = Get-Date ((($startDate.Ticks) + (Get-Random -Minimum 0 -Maximum (($endDate.Ticks) - ($startDate.Ticks)))))
        $sessionDate = $randomDate.ToString("yyyy-MM-ddTHH:mm:ss.fffZ")


        $moodBefore = $moods[(Get-Random -Minimum 0 -Maximum $moods.Count)]
        $moodAfter = $moods[(Get-Random -Minimum 0 -Maximum $moods.Count)]
        $focusLevel = Get-Random -Minimum 1 -Maximum 11  # 1-10
        $stressLevel = Get-Random -Minimum 1 -Maximum 11  # 1-10
        $breathingDepth = Get-Random -Minimum 1 -Maximum 11  # 1-10
        $calmnessScore = Get-Random -Minimum 1 -Maximum 11  # 1-10
        $distractionCount = Get-Random -Minimum 0 -Maximum 6  # 0-5
        $timeOfDay = $timeOfDayOptions[(Get-Random -Minimum 0 -Maximum $timeOfDayOptions.Count)]
        $noiseLevel = Get-Random -Minimum 1 -Maximum 11  # 1-10
        $sessionLength = Get-Random -Minimum 5 -Maximum 61  # 5-60
        $cycles = Get-Random -Minimum 1 -Maximum 11  # 1-10 (default 1, )
        $notes = if ((Get-Random -Minimum 0 -Maximum 2) -eq 0) { "" } else { "Note $(Get-Random -Minimum 1 -Maximum 100)" }


        $body = @{
            sessionDate    = $sessionDate
            moodBefore     = $moodBefore
            moodAfter      = $moodAfter
            focusLevel     = $focusLevel
            stressLevel    = $stressLevel
            breathingDepth = $breathingDepth
            calmnessScore  = $calmnessScore
            distractionCount = $distractionCount
            timeOfDay      = $timeOfDay
            noiseLevel     = $noiseLevel
            sessionLength  = $sessionLength
            cycles         = $cycles
            notes          = $notes
        } | ConvertTo-Json -Compress


        $response = Invoke-RestMethod -Uri "http://localhost:5000/api/sessions" -Method POST -Body $body -ContentType "application/json" -ErrorAction Stop
        Write-Host "Successfully added session for $sessionDate with moodBefore: $moodBefore"
    }
    catch {
        Write-Host "Error adding session: $_"
        Write-Host "Body sent: $body"
    }
}
